services:
  # BrainOS MCP Server (LOCAL TESTING ONLY)
  # This file is for local development with published ports
  # Use docker-compose-test.yml up --build for local testing
  brainos:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: brainos-server-test
    ports:
      - "9131:9131"  # HTTP MCP endpoint (published to host for local testing)
    environment:
      # Neo4j connection (for local Docker testing, use host.docker.internal)
      - NEO4J_URI=bolt://host.docker.internal:7687
      - NEO4J_USER=${NEO4J_USER:-neo4j}
      - NEO4J_PASSWORD=${NEO4J_PASSWORD:-brainos_password_123}

      # Groq API (Fast Actions)
      - GROQ_API_KEY=${GROQ_API_KEY}
      - GROQ_QUICK_MODEL=${GROQ_QUICK_MODEL:-openai/gpt-oss-120b}

      # OpenRouter API (Deep Thinking)
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - OPENROUTER_RESEARCHING_MODEL=${OPENROUTER_RESEARCHING_MODEL:-anthropic/claude-sonnet-4}
      - OPENROUTER_THINKINIG_MODEL=${OPENROUTER_THINKINIG_MODEL:-anthropic/claude-sonnet-4}
      - OPENROUTER_CREATIVE_MODEL=${OPENROUTER_CREATIVE_MODEL:-anthropic/claude-sonnet-4}
      - OPENROUTER_PLANNING_MODEL=${OPENROUTER_PLANNING_MODEL:-anthropic/claude-opus-4}

      - MCP_PORT=${MCP_PORT:-9131}
      - PYTHONUNBUFFERED=1
    restart: unless-stopped

# Note: For local testing, you may also need Neo4j running.
# Start it separately: docker run -p 7687:7687 -p 7474:7474 -e NEO4J_AUTH=neo4j/brainos_password_123 neo4j:5.25-community
