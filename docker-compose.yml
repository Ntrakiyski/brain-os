services:
  # BrainOS MCP Server (HTTP transport for Claude Web)
  # Connects to external Neo4j instance deployed separately in Coolify
  brainos:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: brainos-server
    expose:
      - "9131"  # HTTP MCP endpoint (internal only - Coolify proxy connects here)
    environment:
      # Neo4j connection (external instance - set in Coolify environment variables)
      - NEO4J_URI=${NEO4J_URI:-bolt://localhost:7687}
      - NEO4J_USER=${NEO4J_USER:-neo4j}
      - NEO4J_PASSWORD=${NEO4J_PASSWORD}

      # Groq API (Fast Actions)
      - GROQ_API_KEY=${GROQ_API_KEY}
      - GROQ_QUICK_MODEL=${GROQ_QUICK_MODEL:-openai/gpt-oss-120b}

      # OpenRouter API (Deep Thinking)
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - OPENROUTER_RESEARCHING_MODEL=${OPENROUTER_RESEARCHING_MODEL:-anthropic/claude-sonnet-4}
      - OPENROUTER_THINKINIG_MODEL=${OPENROUTER_THINKINIG_MODEL:-anthropic/claude-sonnet-4}
      - OPENROUTER_CREATIVE_MODEL=${OPENROUTER_CREATIVE_MODEL:-anthropic/claude-sonnet-4}
      - OPENROUTER_PLANNING_MODEL=${OPENROUTER_PLANNING_MODEL:-anthropic/claude-opus-4}

      - MCP_PORT=${MCP_PORT:-9131}
      - PYTHONUNBUFFERED=1
    restart: unless-stopped
